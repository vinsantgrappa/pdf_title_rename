
# FAX受信PDFの自動解析・タイトル変更システム

## 概要
このシステムは、受信したFAXがPDFとして保存される際、内容を自動で解析し、適切なファイル名に変更するPythonアプリケーションです。  
送信者情報が不明なFAXでも、内容を基に送信元を判別し、自動でファイル名を修正することで、管理業務を効率化します。

---

## 制作背景
FAX受信業務における以下の課題を解決するために開発されました：

- **中身の確認作業の負担**  
  毎回PDFを開いて内容を確認する必要があり、処理時間がかかる。
  
- **ファイル名変更の手間**  
  手動でファイル名を変更する作業が煩雑で、ミスの原因となる。
  
- **管理の困難さ**  
  内容不明な仮名（例:「登録名称不明」）で保存されるファイルが増え、管理が煩雑になる。

このシステムは、PDF解析とテンプレートマッチングを活用し、FAX送信元を自動判別することで、これらの課題を解決します。

---

## システムの構成
### 1. PDFテキスト解析
**目的:**  
PDFから文字情報を抽出し、内容を基に送信元を判別します。  

- 匿名で送られてきたFAX　タイトルだけみても、どこから来たFAXかがわからない
![画面収録 2024-12-02 22 30 40](https://github.com/user-attachments/assets/83362cc2-7b13-4624-ae2b-cf079ed458d1)


**手法:**  
- 抽出したテキストをキーワードと照合。  
- 送信元が特定できた場合、適切なファイル名に変更。
![画面収録 2024-12-02 22 37 47](https://github.com/user-attachments/assets/61606602-5d9b-481b-a5ae-8dc09642e658)

- 判別が難しい場合、次のテンプレートマッチングプロセスへ移行。

---

### 2. テンプレートマッチングによる補完
**目的:**  
PDF解析で判別できなかったファイルを画像比較で解析します。  

**手法:**  
- PDFを画像化し、テンプレート画像と一致する箇所を探索。
  
- 探索に使用するテンプレート画像
<img width="1440" alt="スクリーンショット 2024-12-02 22 40 41" src="https://github.com/user-attachments/assets/8d3ee1bc-6bb6-472f-81bc-9a9b83f5065d">

  
- 一致したテンプレート画像に基づき、送信元を判別してファイル名を変更。
![画面収録 2024-12-02 22 42 02](https://github.com/user-attachments/assets/71343b61-c6e2-45a7-8c28-73bf61ff4986)

![画面収録 2024-12-02 22 43 53](https://github.com/user-attachments/assets/e2ed5876-daf5-419d-a05f-137e17c01a18)


**活用例:**  
- 特定の会社ロゴや書式パターンが含まれるFAXの判別。
---

## 導入効果
- **確認作業の自動化**  
  PDF内容を解析することで、手動で確認する手間を削減します。
  
- **ファイル名変更の効率化**  
  送信元情報に基づいて自動でファイル名を変更します。
  
- **管理の改善**  
  明確なファイル名が付与され、ファイル整理や検索が容易になります。

---

## 主な機能
1. **PDFテキスト解析**  
   - PDFから文字情報を抽出し、キーワードマッチングで送信元を判別。

2. **テンプレートマッチング**  
   - PDFを画像化し、ロゴや書式に基づいて送信元を特定。

3. **フォルダ監視**  
   - 指定フォルダを監視し、新しいFAXが追加されるたびに処理を自動実行。

4. **エラー処理**  
   - 内容が特定できない場合でも「登録名称不明」といった仮名で保存。

---

## 使用方法
1. アプリケーションを起動します。
2. 受信FAXが保存されるフォルダを監視対象として設定します。
3. 自動処理が実行され、ファイル名が変更されます。

